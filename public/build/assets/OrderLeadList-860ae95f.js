import{q as z,r as n,b as s,j as e,ao as X,ap as Z,M as ee,aY as B,ah as c,aq as te,u as ae,bc as le,d as se,at as ne,L as re,I as oe,C as ce,o as de,T as ie,p as ue,a as M,as as he,ak as pe,b3 as me,t as G,D as fe,f as be,h as ge,m as Se}from"./app-da34ef76.js";import{s as K,c as q,o as Ce,g as xe}from"./config-b8fb9666.js";const{RangePicker:we}=te,ve=({handleOk:N})=>{var T,P;const F=z("user_data",!0),[L,f]=n.useState(!1),[C,b]=n.useState(!1),[Y,x]=n.useState([]),[k,E]=n.useState([]),[R,D]=n.useState([]),[d,g]=n.useState({contact:null,sales:null,status:null,created_at:null,print_status:null,resi_status:null}),[$,I]=n.useState([]),w=()=>{axios.get("/api/master/top").then(t=>{I(t.data.data)})},S=()=>{f(!0)},v=()=>{axios.get("/api/master/role").then(t=>{x(t.data.data)})},h=()=>{K(null).then(t=>{const o=t.map(u=>({label:u.nama,value:u.id}));E(o)})},_=()=>{q(null).then(t=>{const o=t.map(u=>({label:u.nama,value:u.id}));D(o)})},A=async t=>K(t).then(o=>o.map(m=>({label:m.nama,value:m.id}))),y=async t=>q(t).then(o=>o.map(m=>({label:m.nama,value:m.id})));n.useEffect(()=>{v(),w(),h(),_()},[]);const p=()=>{f(!1),b(!1),g({contact:null,sales:null,status:null,created_at:null,print_status:null,resi_status:null})},i=(t,o)=>{if(o==="createdBy")return g({...d,createdBy:t.value});g({...d,[o]:t})};return s("div",{children:[C?s("button",{onClick:()=>S(),className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(X,{}),e("span",{className:"ml-2",children:"Show Filter"})]}):s("button",{onClick:()=>S(),className:" bg-white border  text-blue-700 hover:text-blue-700/90 delay-100 ease-in-out focus:ring-4 focus:outline-none focus:ring-blue-300  font-medium rounded-lg  text-sm px-4 py-2 text-center inline-flex items-center ",children:[e(Z,{}),e("span",{className:"ml-2",children:"Filter"})]}),s(ee,{title:"Filter",open:L,onOk:()=>{N(d),b(!0),f(!1)},cancelText:C?"Clear Filter":"Cancel",onCancel:C?()=>{f(!1),b(!1),g({contact:null,sales:null,status:null,created_at:null,print_status:null,resi_status:null}),N({})}:p,okText:"Apply Filter",children:[s("div",{children:[s("div",{children:[e("label",{htmlFor:"",children:"Contact"}),e(B,{defaultOptions:k,showSearch:!0,placeholder:"Cari Contact",fetchOptions:A,filterOption:!1,className:"w-full mb-2",onChange:t=>i(t,"contact"),value:(T=d==null?void 0:d.contact)==null?void 0:T.value})]}),s("div",{children:[e("label",{htmlFor:"",children:"Sales"}),e(B,{defaultOptions:Y==="sales"?[{label:F.name,value:F.id}]:R,showSearch:!0,placeholder:"Cari Sales",fetchOptions:y,filterOption:!1,className:"w-full mb-2",onChange:t=>i(t,"sales"),value:(P=d==null?void 0:d.sales)==null?void 0:P.value})]}),s("div",{children:[e("label",{htmlFor:"",children:"Status"}),s(c,{mode:"multiple",allowClear:!0,className:"w-full mb-2",placeholder:"Select Status",onChange:t=>i(t,"status"),children:[e(c.Option,{value:1,children:"New"}),e(c.Option,{value:2,children:"Open"}),e(c.Option,{value:3,children:"Closed"}),e(c.Option,{value:4,children:"Canceled"})]})]}),s("div",{className:"mb-2",children:[e("label",{htmlFor:"",children:"Tanggal"}),e(we,{className:"w-full",format:"YYYY-MM-DD",onChange:(t,o)=>i(o,"created_at")})]})]}),s("div",{children:[e("label",{htmlFor:"",children:"Payment Term"}),e(c,{mode:"multiple",allowClear:!0,className:"w-full mb-2",placeholder:"Select Payment Term",onChange:t=>i(t,"payment_term"),children:$.map(t=>e(c.Option,{value:t.id,children:t.name},t.id))})]}),s("div",{children:[e("label",{htmlFor:"",children:"Status Print"}),s(c,{allowClear:!0,className:"w-full mb-2",placeholder:"Select Status Print",onChange:t=>i(t,"print_status"),children:[e(c.Option,{value:"printed",children:"Printed"}),e(c.Option,{value:"not yet",children:"Not Yet"})]})]}),s("div",{children:[e("label",{htmlFor:"",children:"Resi Sudah Diinput"}),s(c,{allowClear:!0,className:"w-full mb-2",placeholder:"Select Resi Sudah Diinput",onChange:t=>i(t,"resi_status"),children:[e(c.Option,{value:"done",children:"Done"}),e(c.Option,{value:"not yet",children:"Not Yet"})]})]})]})]})},Oe=()=>{const N=ae(),[F,L]=n.useState(!1),[f,C]=n.useState([]),[b,Y]=n.useState(0),[x,k]=n.useState(""),[E,R]=n.useState(!1),[D,d]=n.useState(1),[g,$]=n.useState({}),[I,w]=n.useState(!1),[S,v]=n.useState([]),[h,_]=n.useState(!1),[A,y]=n.useState(!1),p=(l="/api/order-lead",r=10,O={page:D})=>{L(!0),M.post(l,{perpage:r,account_id:z("account_id"),...O}).then(J=>{const{data:Q,total:U,current_page:V}=J.data.data;Y(U),d(V);const W=Q.map(a=>({id:a.uid_lead,order_number:a.order_number,contact:(a==null?void 0:a.contact_name)||"-",sales:(a==null?void 0:a.sales_name)||"-",created_by:(a==null?void 0:a.created_by_name)||"-",created_on:he(a.created_at).format("DD-MM-YYYY"),amount_total:`Rp ${pe(a==null?void 0:a.amount)}`,payment_term:(a==null?void 0:a.payment_term_name)||"-",status:me(a==null?void 0:a.status),status_submit:a==null?void 0:a.status_submit,print_status:a==null?void 0:a.print_status,resi_status:a==null?void 0:a.resi_status}));C(W),L(!1)})};n.useEffect(()=>{p()},[]);const i=(l,r=10)=>{p(`/api/order-lead/?page=${l}`,r,{search:x,page:l,...g})},j=()=>{R(!0),p("/api/order-lead",10,{search:x})},T=l=>{$(l),p("/api/order-lead",10,l)},P=()=>{w(!0),M.post("/api/order-lead/export/detail/1").then(l=>{const{data:r}=l.data;window.open(r),w(!1)}).catch(l=>w(!1))},t=l=>{y(!0),M.post("/api/order/order-lead/submit",{ids:S,type:"order-lead",...l}).then(r=>{const{data:O}=r.data;G.success("Order Lead berhasil di submit"),y(!1),_(!1),v([]),console.log(O,"data")}).catch(r=>{y(!1),G.error("Error submitting order lead")})},o=s("div",{className:"flex justify-between items-center",children:[S.length>0&&e(le,{handleSubmit:l=>t(l)}),e("button",{onClick:()=>h?(v([]),_(!1)):_(!0),className:`text-white bg-${h?"red":"blue"}-700 hover:bg-${h?"red":"blue"}-800 focus:ring-4 focus:outline-none focus:ring-${h?"red":"blue"}-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center mr-2`,children:e("span",{className:"ml-2",children:h?"Cancel Submit":"Ready To Submit"})}),e(ve,{handleOk:T}),s("button",{className:"ml-3 text-white bg-green-800 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center mr-2",onClick:()=>P(),children:[I?e(se,{}):e(ne,{}),e("span",{className:"ml-2",children:"Export"})]})]}),u=(l,r)=>{switch(l){case"detail":N(`/order/order-lead/${r.id}`);break;case"detail_new_tab":window.open(`/order/order-lead/${r.id}`);break;case"cancel":return window.location.reload(),M.get(`/api/order-lead/cancel/${r.id}`).then(()=>{Se.success("Order Lead berhasil di cancel")})}},m=[{title:"Action",key:"id",align:"center",fixed:"right",width:100,render:(l,r)=>e(fe.Button,{style:{width:90},overlay:e(be,{onClick:({key:O})=>u(O,r),itemIcon:e(ge,{}),items:xe(r==null?void 0:r.status)})})}],H={selectedRowKeys:S,onChange:l=>v(l),getCheckboxProps:l=>l.status!=="Closed"?{disabled:!0}:l.status_submit==="submited"?{disabled:!0}:{disabled:!1}};return s(re,{rightContent:o,title:"List Order Lead",children:[s("div",{className:"row mb-4",children:[e("div",{className:"col-md-12"}),e("div",{className:"col-md-4 col-sm-6 col-12",children:e(oe,{placeholder:"Cari disini",size:"large",className:"rounded",onPressEnter:()=>j(),suffix:E?e(ce,{onClick:()=>{p(),k(null),R(!1)}}):e(de,{onClick:()=>j()}),value:x,onChange:l=>k(l.target.value)})}),e("div",{className:"col-md-8",children:s("strong",{className:"float-right mt-3 text-red-400",children:["Total Data: ",b]})})]}),e(ie,{dataSource:f,columns:[...Ce,...m],loading:F,pagination:!1,rowKey:"id",scroll:{x:"max-content"},tableLayout:"auto",rowSelection:h?H:null}),e(ue,{defaultCurrent:1,current:D,total:b,className:"mt-4 text-center",onChange:i,pageSizeOptions:["10","20","50","100","200","500"]})]})};export{Oe as default};
