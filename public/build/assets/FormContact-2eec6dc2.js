import{r as t,b as i,j as e,am as se,M as G,ag as S,b5 as re,u as te,F as l,s as oe,L as me,an as H,I as r,ah as s,aq as de,U as ce,d as V,P as pe,c as ue,a as b,as as he,b6 as ye,b0 as m,g as be,t as u}from"./app-eabe49db.js";const _e=({checked:_,data:p,onDisabled:d})=>{const[T,g]=t.useState(!1),[k,I]=t.useState(!1),[c,f]=t.useState(!1),h=t.useRef();return console.log(h.current,"modalref"),i("div",{children:[e(se,{checked:_,className:"mb-2",onChange:C=>_?f(!0):g(!0),children:_?e("span",{className:"text-danger",children:"Matikan Notifikasi Telegram"}):e("span",{className:"text-primary",children:"Beri Saya Notifikasi Telegram"})}),e(G,{open:T,title:"Tautkan Telegram",width:700,footer:null,onCancel:()=>g(!1),children:i("div",{ref:h,children:[e("p",{children:"Berikut adalah cara untuk menautkan akun telegram anda, untuk mendapatkan realtime notifikasi."}),i("ol",{children:[i("li",{className:"mb-4",children:["1. Klik Tombol"," ",e("span",{onClick:()=>{h.current&&(h.current.scrollIntoView({behavior:"smooth",block:"end"}),setTimeout(()=>{I(!0),setTimeout(()=>{I(!1),h.current.scrollIntoView({behavior:"smooth",block:"start"})},1500)},500))},className:"text-primary cursor-pointer",children:"Tautkan sekarang"})," ","dibagian bawah atau"," ",e("a",{href:"https://t.me/momsy_bot",target:"_blank",className:"text-primary",children:"Klik Disini"})]}),i("li",{className:"mb-4",children:[e("p",{children:"2. Setelah Masuk Ke Chat Kemudian Klik Start"}),e("img",{src:"https://i.ibb.co/6NhXjWP/Screenshot-2023-07-04-at-11-31-44.png",alt:"",className:"h-52 rounded-md mx-auto"})]}),i("li",{className:"mb-4",children:[i("p",{children:[" ","3. Selanjutnya Masukkan dan Kirim Kode Berikut Di Dalam Chat"," ",e("span",{className:"text-primary",children:p==null?void 0:p.uid})]}),e("img",{src:"https://i.ibb.co/JrKrMpK/Screenshot-2023-07-04-at-12-18-55.png",alt:"",className:"h-52 rounded-md mx-auto"})]}),i("li",{className:"mb-4",children:[e("p",{children:"4. Setelah Langkah-Langkah Diatas Selesai, anda akan mendapatkan balasan bahwa penyiapan akun notifikasi telah selesai."}),e("img",{src:"https://i.ibb.co/SRJFSGt/Screenshot-2023-07-04-at-12-21-17.png",alt:"",className:"h-52 rounded-md mx-auto"})]})]}),i("div",{className:"flex justify-end pt-3 border-t-[1px]",children:[e(S,{className:"mr-3",onClick:()=>{g(!1)},children:"Tutup"}),e(re,{placement:"topLeft",open:k,content:e("div",{children:e("p",{children:"Klik disini untuk menautkan"})}),children:e(S,{onClick:()=>{window.open("https://t.me/momsy_bot")},type:"primary",children:"Tautkan Sekarang"})})]})]})}),e(G,{title:"Matikan Notifikasi Telegram",open:c,onOk:()=>{f(!1),d()},cancelText:"Tutup",onCancel:()=>f(!1),okText:"Ya, Matikan",width:700,children:e("div",{children:e("p",{children:"Apakah Kamu Yakin Ingin Menonaktifkan notifikasi Telegram?"})})})]})},Ne=()=>{const _=te(),[p]=l.useForm(),d=oe();localStorage.getItem("role");const[T,g]=t.useState([]),[k,I]=t.useState([]),[c,f]=t.useState([]),[h,C]=t.useState([]),[ge,O]=t.useState(""),[X,v]=t.useState(null),[P,K]=t.useState({file_nib:!1}),[w,$]=t.useState({file_nib:null}),[M,z]=t.useState({file_nib:null}),Q=()=>{b.get("/api/master/brand").then(n=>{g(n.data.data)})},q=()=>{b.get(`/api/contact/detail/${d==null?void 0:d.user_id}`).then(n=>{var o,y,N,x,B,D,L,E,F,R,Y,U,j,J,W,A;const{data:a}=n.data;f(a),v((o=a==null?void 0:a.role)==null?void 0:o.role_type),p.setFieldsValue({...a,bod:he(a.bod??new Date,"YYYY-MM-DD"),role_id:(y=a==null?void 0:a.role)==null?void 0:y.id,brand_id:ye(a==null?void 0:a.brands,"id"),company_name:m((N=a==null?void 0:a.company)==null?void 0:N.name),company_email:m((x=a==null?void 0:a.company)==null?void 0:x.email),company_telepon:m((B=a==null?void 0:a.company)==null?void 0:B.phone),business_entity:(L=(D=a==null?void 0:a.company)==null?void 0:D.business_entity)==null?void 0:L.id,owner_name:m((E=a==null?void 0:a.company)==null?void 0:E.owner_name),pic_name:m((F=a==null?void 0:a.company)==null?void 0:F.pic_name),owner_phone:m((R=a==null?void 0:a.company)==null?void 0:R.owner_phone),pic_phone:m((Y=a==null?void 0:a.company)==null?void 0:Y.pic_phone),company_address:m((U=a==null?void 0:a.company)==null?void 0:U.address),layer_type:m((j=a==null?void 0:a.company)==null?void 0:j.layer_type),npwp:m((J=a==null?void 0:a.company)==null?void 0:J.npwp),npwp_name:m((W=a==null?void 0:a.company)==null?void 0:W.npwp_name),nib:m((A=a==null?void 0:a.company)==null?void 0:A.nib)})})},Z=()=>{b.get("/api/master/bussiness-entity").then(n=>{C(n.data.data)})},ee=()=>{b.get("/api/master/role").then(n=>{I(n.data.data)})},ae=({fileList:n,field:a})=>{const o=n.pop();K({...P,[a]:!0}),setTimeout(()=>{be(o.originFileObj,y=>{K({...P,[a]:!1}),$({...w,[a]:y})}),z({...n,[a]:o.originFileObj})},1e3)};t.useEffect(()=>{q(),Q(),Z(),ee()},[]);const ne=n=>{let a=new FormData;M.file_nib&&a.append("file_nib",M.file_nib),d!=null&&d.user_id&&a.append("user_id",d==null?void 0:d.user_id),a.append("bod",n.bod.format("YYYY-MM-DD")),a.append("sales_channel",JSON.stringify(n.sales_channels)),a.append("name",n.name||null),a.append("uid",n.uid||null),a.append("telepon",n.telepon||null),a.append("email",n.email||null),a.append("gender",n.gender||null),a.append("brand_id",n.brand_id||null),a.append("role_id",n.role_id||null),a.append("layer_type",n.layer_type||null),a.append("company_name",n.company_name||null),a.append("company_email",n.company_email||null),a.append("npwp",n.npwp||null),a.append("npwp_name",n.npwp_name||null),a.append("company_telepon",n.company_telepon||null),a.append("business_entity",n.business_entity||null),a.append("owner_name",n.owner_name||null),a.append("owner_phone",n.owner_phone||null),a.append("nib",n.nib||null),a.append("pic_name",n.pic_name||null),a.append("pic_phone",n.pic_phone||null),a.append("company_address",n.company_address||null),b.post("/api/contact/save-contact",a).then(o=>(O(o.data.message),u.success(o.data.message,{position:u.POSITION.TOP_RIGHT}),_("/contact/list"))).catch(o=>{const{message:y,type:N}=o.response.data;N==="company_email"&&p.setFields([{name:"company_email",errors:["company email has been registered"]}]),N==="company_name"&&p.setFields([{name:"company_name",errors:["company name has been registered"]}]),u.error(y,{position:u.POSITION.TOP_RIGHT})})},le=()=>{b.post("/api/contact/disabled-telegram",{user_id:c==null?void 0:c.id}).then(n=>(O(n.data.message),u.success(n.data.message,{position:u.POSITION.TOP_RIGHT}),q())).catch(n=>{const{message:a,type:o}=n.response.data;u.error(a,{position:u.POSITION.TOP_RIGHT})})},ie=!!(c!=null&&c.telegram_chat_id);return e(me,{title:"Tambah Contact Baru",href:"/contact/list",children:i(l,{form:p,name:"basic",layout:"vertical",onFinish:ne,autoComplete:"off",children:[e(H,{title:"User Info",children:i("div",{className:"card-body row",children:[e("div",{className:"col-md-6",children:e(l.Item,{label:"Nama lengkap",name:"name",rules:[{required:!0,message:"Please input your nama lengkap!"}],children:e(r,{placeholder:"Ketik Nama Lengkap"})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Customer Code",name:"uid",rules:[{required:!0,message:"Please input your Customer Code!"}],children:e(r,{placeholder:"Ketik Customer Code"})})}),i("div",{className:"col-md-6",children:[e(l.Item,{label:"Telepon",name:"telepon",rules:[{required:!0,message:"Please input your Telepon!"}],tooltip:"Untuk menggunakan notifikasi melalui telegram, anda perlu mendaftarkan nomor telepon anda ke telegram terlebih dahulu",className:"mb-2",children:e(r,{placeholder:"Ketik No Telepon"})}),e(_e,{checked:ie,data:c,onDisabled:()=>le()})]}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your password!"}],children:e(r,{placeholder:"Ketik Email"})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Jenis Kelamin",name:"gender",rules:[{required:!0,message:"Please input your Jenis Kelamin!"}],children:i(s,{placeholder:"Select Jenis Kelamin",children:[e(s.Option,{value:"Laki-Laki",children:"Laki-Laki"}),e(s.Option,{value:"Perempuan",children:"Perempuan"})]})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Birth of Date",name:"bod",rules:[{required:!0,message:"Please input your Birth of Date!"}],children:e(de,{className:"w-full"})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Brand",name:"brand_id",rules:[{required:!0,message:"Please input your Brand!"}],children:e(s,{placeholder:"Select Brand",mode:"multiple",children:T.map(n=>e(s.Option,{value:n.id,children:n.name},n.id))})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Role",name:"role_id",rules:[{required:!0,message:"Please input your Role!"}],children:e(s,{placeholder:"Select Role",onChange:n=>{const a=k.find(o=>o.id===n);v(a.role_type)},children:k.map(n=>e(s.Option,{value:n.id,children:n.role_name},n.id))})})}),X==="agent"&&e("div",{className:"col-md-6",children:e(l.Item,{label:"Type Layer",name:"layer_type",rules:[{required:!0,message:"Please input your Type Layer!"}],children:i(s,{placeholder:"Select Type Layer",children:[e(s.Option,{value:"distributor",children:"Main Mitra"}),e(s.Option,{value:"sub-distributor",children:"Sub Mitra"})]})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Sales Tag",name:"sales_channels",rules:[{required:!0,message:"Please input your Sales Channel!"}],children:i(s,{mode:"multiple",allowClear:!0,className:"w-full mb-2",placeholder:"Select Sales Channel",children:[e(s.Option,{value:"mitra",children:"Mitra"}),e(s.Option,{value:"distributor",children:"Distributor"}),e(s.Option,{value:"e-store",children:"E-Store"})]})})})]})}),e(H,{title:"Company Info",className:"mt-2",children:i("div",{className:"card-body row",children:[i("div",{className:"col-md-6",children:[e(l.Item,{label:"Company Name",name:"company_name",rules:[{required:!1,message:"Please input your Company Name!"}],children:e(r,{placeholder:"Ketik Company Name"})}),e(l.Item,{label:"Company Email",name:"company_email",rules:[{required:!1,message:"Please input your Company Email!"}],children:e(r,{placeholder:"Ketik Company Email"})})]}),i("div",{className:"col-md-6",children:[e(l.Item,{label:"No. NPWP",name:"npwp",rules:[{required:!1,message:"Please input your NPWP Number!"}],children:e(r,{placeholder:"Ketik No. NPWP"})}),e(l.Item,{label:"Nama NPWP",name:"npwp_name",children:e(r,{placeholder:"Ketik Nama NPWP"})})]}),i("div",{className:"col-md-6",children:[e(l.Item,{label:"Company Telepon",name:"company_telepon",rules:[{required:!1,message:"Please input your Company Telepon!"}],children:e(r,{placeholder:"Ketik Owner Name"})}),e(l.Item,{label:"Business Entity",name:"business_entity",children:e(s,{placeholder:"Select Business Entity",children:h.map(n=>e(s.Option,{value:n.id,children:n.title},n.id))})})]}),i("div",{className:"col-md-6",children:[e(l.Item,{label:"Owner Name",name:"owner_name",rules:[{required:!1,message:"Please input your Owner Name!"}],children:e(r,{placeholder:"Ketik Owner Name"})}),e(l.Item,{label:"Owner Telepon",name:"owner_phone",rules:[{required:!1,message:"Please input your Owner Telepon!"}],children:e(r,{placeholder:"Ketik Owner Telepon"})})]}),e("div",{className:"col-md-6",children:e(l.Item,{label:"NIB",name:"nib",children:e(r,{placeholder:"Ketik NIB"})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"file_nib",name:"file_nib",rules:[{required:!1,message:"Please input file_nib!"}],children:e(ce,{name:"file_nib",listType:"picture-card",className:"avatar-uploader w-100",showUploadList:!1,multiple:!1,beforeUpload:()=>!1,onChange:n=>ae({...n,field:"file_nib"}),children:w.file_nib?P.file_nib?e(V,{}):e("img",{src:w.file_nib,alt:"avatar",style:{height:104}}):i("div",{style:{width:"100%"},children:[P.file_nib?e(V,{}):e(pe,{}),e("div",{style:{marginTop:8,width:"100%"},children:"Upload"})]})})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"PIC Name",name:"pic_name",rules:[{required:!1,message:"Please input your PIC Name!"}],children:e(r,{placeholder:"Ketik PIC Name"})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"PIC Telepon",name:"pic_phone",rules:[{required:!1,message:"Please input your PIC Telepon!"}],children:e(r,{placeholder:"Ketik PIC Telepon"})})}),e("div",{className:"col-md-12",children:e(l.Item,{label:"Company Address",name:"company_address",rules:[{required:!1,message:"Please input your Company Address!"}],children:e(ue,{placeholder:"Ketik Company Address"})})}),e("div",{className:"col-md-12 ",children:e("div",{className:"float-right",children:e(l.Item,{children:e(S,{type:"primary",htmlType:"submit",children:"Save Contact"})})})})]})})]})})};export{Ne as default};
