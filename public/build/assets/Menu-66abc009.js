import{s as A,M as j,a as $,b as G,c as K}from"./index-8500e050.js";import{r as p,j as e,A as q,_ as k,F as x,b as c,bn as Y,P as z,M as C,ah as I,I as P,a as O,t as l,T as R,L as U,S as D,k as J,v as Q}from"./app-dfe09891.js";import{F as H}from"./FolderFilled-a11f9621.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"};const X=W;var F=function(o,i){return e(q,{...k(k({},o),{},{ref:i,icon:X})})};F.displayName="KeyOutlined";const B=p.forwardRef(F),E=({refetch:s,initialValues:o={},update:i=!1,parents:b=[],url:u})=>{const[g]=x.useForm(),[y,h]=p.useState(!1),[S,N]=p.useState([]),[M,_]=p.useState(!0),f=()=>{O.get("/api/master/role").then(r=>{_(!1),N(r.data.data)})},w=()=>{h(!0)};p.useEffect(()=>{M&&f()},[M]);const T=r=>{O.post(u,{...o,...r}).then(n=>{const{message:t}=n.data;g.resetFields(),h(!1),s(),l.success(t,{position:l.POSITION.TOP_RIGHT})}).catch(n=>{n.response.data})};return c("div",{children:[i?e("button",{onClick:()=>w(),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center mr-2",children:e(Y,{})}):c("button",{onClick:()=>w(),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(z,{}),e("span",{className:"ml-2",children:"Menu Baru"})]}),e(C,{title:i?"Edit Menu":"Tambah Menu Baru",open:y,cancelText:"Batal",okText:"Simpan",onCancel:()=>h(!1),onOk:()=>g.submit(),width:1e3,children:e(x,{form:g,name:"basic",layout:"vertical",initialValues:{...o,role_id:o.role_id?o.role_id:["aaf5ab14-a1cd-46c9-9838-84188cd064b6"],show_menu:o.show_menu?o.show_menu:"1"},onFinish:T,autoComplete:"off",children:c("div",{className:"row",children:[e("div",{className:"col-md-4",children:e(x.Item,{label:"Parent Menu",name:"parent_id",children:e(I,{allowClear:!0,className:"w-full mb-2",placeholder:"Pilih Parent Menu",children:b.map(r=>e(I.Option,{value:r.id,children:r.menu_label},r.id))})})}),e("div",{className:"col-md-4",children:e(x.Item,{label:"Nama Menu",name:"menu_label",rules:[{required:!0,message:"Please input your Nama Menu!"}],children:e(P,{})})}),e("div",{className:"col-md-4",children:e(x.Item,{label:"Menu Icon",name:"menu_icon",children:e(P,{placeholder:"fas fa-dashboard"})})}),c("div",{className:"col-md-6",children:[e(x.Item,{label:"Menu Route",name:"menu_route",rules:[{required:!0,message:"Please input your Menu Route!"}],children:e(P,{placeholder:"menu.index"})}),e(x.Item,{label:"Role",name:"role_id",rules:[{required:!0,message:"Please input your Role!"}],children:c(I,{mode:"multiple",allowClear:!0,className:"w-full mb-2",placeholder:"Pilih Role",children:[e(I.Option,{value:"aaf5ab14-a1cd-46c9-9838-84188cd064b6",children:"Superadmin"},"aaf5ab14-a1cd-46c9-9838-84188cd064b6"),S.map(r=>e(I.Option,{value:r.id,children:r.role_name},r.id))]})})]}),c("div",{className:"col-md-6",children:[e(x.Item,{label:"Menu Badge",name:"badge",placeholder:"badge",children:e(P,{})}),e(x.Item,{label:"Show Menu",name:"show_menu",rules:[{required:!0,message:"Please input your Show Menu!"}],children:c(I,{allowClear:!0,className:"w-full mb-2",placeholder:"Pilih Kabupaten",children:[e(I.Option,{value:"1",children:"Ya"},1),e(I.Option,{value:"0",children:"Tidak"},0)]})})]})]})})})]})},Z=A(()=>e(j,{style:{cursor:"grab",color:"#999"}})),L=[{title:"Sort",key:"sort",dataIndex:"sort",width:30,className:"drag-visible",render:()=>e(Z,{})},{title:"Nama Menu",key:"menu_label",dataIndex:"menu_label"},{title:"Menu Url",key:"menu_url",dataIndex:"menu_url"}],V=[{title:"#",key:"id",dataIndex:"id",render:(s,o,i)=>i+1},{title:"Nama Role",key:"name",dataIndex:"name"}],ee=({actionColumns:s=[],dataSource:o=[],loading:i=!1,hasChildren:b=!1,title:u="Submenu"})=>{const[g,y]=p.useState(!1),h=()=>{y(!0)};return c("div",{children:[b?c("button",{onClick:()=>h(),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(B,{}),e("span",{className:"ml-2",children:"Role"})]}):c("button",{className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(B,{}),e("span",{className:"ml-2",children:"Role"})]}),e(C,{title:u,open:g,cancelText:"Tutup",onCancel:()=>y(!1),okButtonProps:{style:{display:"none"}},width:800,children:e(R,{dataSource:o,columns:[...V,...s],loading:i,pagination:!1,rowKey:"id",scroll:{x:"max-content"},tableLayout:"auto"})})]})},te=$(s=>e("tr",{...s})),ne=G(s=>e("tbody",{...s})),ae=({actionColumns:s=[],dataSource:o=[],loading:i=!1,hasChildren:b=!1,title:u="Submenu",refetch:g})=>{const[y,h]=p.useState(!1),S=()=>{h(!0)},N=({oldIndex:f,newIndex:w})=>{if(f!==w){const r=K(o.slice(),f,w).filter(n=>!!n).map((n,t)=>({value:t+1,id:n.id}));axios.post("/api/menu/order",{menus:r}).then(n=>{const{message:t}=n.data;g(),l.success(t,{position:l.POSITION.TOP_RIGHT})})}};return c("div",{children:[b?c("button",{onClick:()=>S(),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(H,{}),e("span",{className:"ml-2",children:"Submenu"})]}):c("button",{className:"text-white bg-gray-400 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(H,{}),e("span",{className:"ml-2",children:"Submenu"})]}),e(C,{title:u,open:y,cancelText:"Tutup",onCancel:()=>h(!1),okButtonProps:{style:{display:"none"}},width:1e3,children:e(R,{components:{body:{wrapper:f=>e(ne,{useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:N,...f}),row:({className:f,style:w,...T})=>{const r=o.findIndex(n=>n.index===T["data-row-key"]);return e(te,{index:r,...T})}}},dataSource:o,columns:[...L,...s],loading:i,pagination:!1,rowKey:"index",scroll:{x:"max-content"},tableLayout:"auto"})})]})},se=$(s=>e("tr",{...s})),le=G(s=>e("tbody",{...s})),ue=()=>{const[s,o]=p.useState([]),[i,b]=p.useState(!1),u=()=>{b(!0),O.get("/api/menu/list").then(n=>{const{data:t}=n.data;b(!1);const a=t.map((d,m)=>({...d,index:m}));o(a)}).catch(n=>{b(!1)})},g=n=>{O.post(`/api/menu/update/${n.id}`,n).then(t=>{const{message:a}=t.data;u(),l.success(a,{position:l.POSITION.TOP_RIGHT})}).catch(t=>{const{message:a}=t.response.data;l.error(a,{position:l.POSITION.TOP_RIGHT})})},y=(n,t)=>{O.post(`/api/menu/role/update/${n.menu_id}`,{role_id:n.id,value:t}).then(a=>{const{message:d}=a.data;u(),l.success(d,{position:l.POSITION.TOP_RIGHT})}).catch(a=>{const{message:d}=a.response.data;l.error(d,{position:l.POSITION.TOP_RIGHT})})},h=n=>{O.post(`/api/menu/delete/${n}`,{_method:"DELETE"}).then(t=>{const{message:a}=t.data;u(),l.success(a,{position:l.POSITION.TOP_RIGHT})}).catch(t=>{const{message:a}=t.response.data;l.error(a,{position:l.POSITION.TOP_RIGHT})})};p.useEffect(()=>(u(),()=>{}),[]);const S=[{title:"Show Menu",key:"show_menu",dataIndex:"show_menu",render:(n,t)=>e(D,{checked:n>0,onChange:a=>g({...t,show_menu:a?"1":"0"})})}],N=[{title:"Permission",key:"status",dataIndex:"status",render:(n,t)=>e(D,{checked:n,onChange:a=>y(t,a)})}],M=[{title:"Permission Role",key:"role",dataIndex:"role",render:(n,t)=>{var a;return e(ee,{actionColumns:N,dataSource:t.roles,loading:i,hasChildren:((a=t==null?void 0:t.roles)==null?void 0:a.length)>0,title:`Permission Role of ${t.menu_label}`})}}],_=[{title:"Actions",key:"action",dataIndex:"action",render:(n,t)=>c("div",{className:"flex justify-between items-center",children:[e(E,{refetch:()=>u(),initialValues:t,update:!0,parents:s,url:`/api/menu/update/${t.id}`}),e(J,{title:"Yakin Hapus Data ini?",onConfirm:()=>h(t.id),okText:"Ya, Hapus",cancelText:"Batal",children:e("button",{className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:e(Q,{})})})]})}],f=[...S,{title:"Submenu",key:"submenu",dataIndex:"submenu",render:(n,t)=>{const a=t.childrens.map((d,m)=>({...d,index:m}));return e(ae,{actionColumns:[...S,...M,..._],dataSource:a,loading:i,hasChildren:a.length>0,title:`Submenu of ${t.menu_label}`,refetch:()=>u()})}},...M,..._],w=({oldIndex:n,newIndex:t})=>{if(n!==t){const d=K(s.slice(),n,t).filter(m=>!!m).map((m,v)=>({value:v+1,id:m.id}));O.post("/api/menu/order",{menus:d}).then(m=>{const{message:v}=m.data;u(),l.success(v,{position:l.POSITION.TOP_RIGHT})})}};return e(U,{title:"Menu",rightContent:e(E,{refetch:()=>u(),parents:s,url:"/api/menu/create"}),children:e(R,{components:{body:{wrapper:n=>e(le,{useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:w,...n}),row:({className:n,style:t,...a})=>{const d=s.findIndex(m=>m.index===a["data-row-key"]);return e(se,{index:d,...a})}}},dataSource:s,columns:[...L,...f],loading:i,pagination:!1,rowKey:"index",scroll:{x:"max-content"},tableLayout:"auto"})})};export{ue as default};
