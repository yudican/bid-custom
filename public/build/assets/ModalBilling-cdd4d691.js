import{bu as S,r,q as L,b as n,j as e,P as f,M as q,F as l,I,aq as D,c as j,U as w,d as u,g as B,a as Y,t as x}from"./app-8c157319.js";const E=({refetch:N,detail:P,user:F})=>{const[g]=S(),[A,m]=r.useState(!1),[i,b]=r.useState({attachment:!1,struct:!1}),[c,_]=r.useState({attachment:null,struct:null}),[d,T]=r.useState({attachment:null,struct:null}),[U,p]=r.useState(!1),O=()=>{p(!0)},k=()=>{p(!1)},y=["account_name","account_bank","total_transfer"],v=({fileList:t,field:a})=>{const o=t.pop();b(s=>({...s,[a]:!0})),setTimeout(()=>{B(o.originFileObj,s=>{b(h=>({...h,[a]:!1})),_(h=>({...h,[a]:s}))}),T(s=>({...s,[a]:o.originFileObj}))},1e3)},C=t=>{m(!0);let a=new FormData;d.attachment&&a.append("upload_billing_photo",d.attachment),d.struct&&a.append("upload_transfer_photo",d.struct),console.log(t,"value"),a.append("uid_lead",P.uid_lead),a.append("account_name",t.account_name),a.append("account_bank",t.account_bank),a.append("total_transfer",t.total_transfer),a.append("notes",t.notes),a.append("transfer_date",t.transfer_date.format("YYYY-MM-DD")),Y.post("/api/order-manual/billing",a).then(o=>{const{message:s}=o.data;N(),T({attachment:null,struct:null}),_({attachment:null,struct:null}),x.success(s,{position:x.POSITION.TOP_RIGHT}),p(!1),m(!1)}).catch(o=>m(!1))},M=L("role")==="finance";return n("div",{children:[n("button",{onClick:()=>O(),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(f,{}),e("span",{className:"ml-2",children:"Tambah Data"})]}),e(q,{title:"Informasi Penagihan",open:U,onOk:()=>{g.submit()},cancelText:"Cancel",onCancel:k,okText:"Simpan",children:e(l,{form:g,name:"basic",layout:"vertical",initialValues:{user_approval:F.name},onFinish:C,autoComplete:"off",children:n("div",{className:"row",children:[n("div",{className:"col-md-12",children:[M&&e(l.Item,{label:"User Approval",name:"user_approval",children:e(I,{disabled:!0})}),y.map((t,a)=>e(l.Item,{label:t.replace("_"," ").toUpperCase(),name:t,rules:[{required:!0,message:"Field Tidak Boleh Kosong!"}],children:e(I,{})},a)),e(l.Item,{label:"Tanggal Transfer",name:"transfer_date",rules:[{required:!0,message:"Field Tidak Boleh Kosong!"}],children:e(D,{className:"w-full"})})]}),e("div",{className:"col-md-12",children:e(l.Item,{label:"Notes",name:"notes",rules:[{required:!1,message:"Please input notes!"}],children:e(j,{})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Billing Photo",name:"upload_billing_photo",rules:[{required:!1,message:"Please input Photo!"}],children:e(w,{name:"attachment",listType:"picture-card",className:"avatar-uploader w-100",showUploadList:!1,multiple:!1,beforeUpload:()=>!1,onChange:t=>v({...t,field:"attachment"}),children:c.attachment?i.attachment?e(u,{}):e("img",{src:c.attachment,alt:"avatar",style:{height:104}}):n("div",{style:{width:"100%"},children:[i.attachment?e(u,{}):e(f,{}),e("div",{style:{marginTop:8,width:"100%"},children:"Upload"})]})})})}),e("div",{className:"col-md-6",children:e(l.Item,{label:"Transfer Photo",name:"upload_transfer_photo",rules:[{required:!1,message:"Please input Photo!"}],children:e(w,{name:"struct",listType:"picture-card",className:"avatar-uploader w-100",showUploadList:!1,multiple:!1,beforeUpload:()=>!1,onChange:t=>v({...t,field:"struct"}),children:c.struct?i.struct?e(u,{}):e("img",{src:c.struct,alt:"avatar",style:{height:104}}):n("div",{className:"w-100",children:[i.struct?e(u,{}):e(f,{}),e("div",{style:{marginTop:8,width:"100%"},children:"Upload"})]})})})})]})})})]})};export{E as M};
