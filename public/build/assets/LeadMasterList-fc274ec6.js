import{j as e,d as j,b as s,r as l,ao as A,ap as G,M as J,aY as T,ah as u,aq as Q,a as E,u as W,s as H,at as V,P as X,L as Z,I as ee,C as te,o as ae,T as le,p as ne,q as se}from"./app-becce45d.js";import{s as I,a as oe}from"./service-372f6e11.js";import{l as re}from"./config-fb67379f.js";const ce=({loading:x=!1,disabled:v=!1,color:c="blue",label:i="Button",icon:d=null,onClick:h,className:m})=>x?e("button",{className:`ml-3 text-white bg-${c}-800 hover:bg-${c}-800 focus:ring-4 focus:outline-none focus:ring-${c}-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center ${m}}`,disabled:!0,children:e(j,{})}):v?s("button",{className:`ml-3 text-white bg-gray-800 hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center ${m}}`,disabled:!0,children:[e("span",{className:"mr-2  mb-1",children:d}),e("span",{children:i})]}):s("button",{className:`ml-3 text-white bg-${c}-800 hover:bg-${c}-800 focus:ring-4 focus:outline-none focus:ring-${c}-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center ${m}}`,onClick:h,children:[e("span",{className:"mr-2 mb-1",children:d}),e("span",{children:i})]}),{RangePicker:ie}=Q,ue=({handleOk:x})=>{var M,y;const v=JSON.parse(localStorage.getItem("user_data")),[c,i]=l.useState(!1),[d,h]=l.useState(!1),[m,F]=l.useState([]),[k,C]=l.useState([]),[L,D]=l.useState([]),[o,f]=l.useState({contact:null,sales:null,status:null,created_at:null}),_=()=>{i(!0)},R=()=>{E.get("/api/master/role").then(t=>{F(t.data.data)})},P=()=>{I(null).then(t=>{const r=t.map(S=>({label:S.nama,value:S.id}));C(r)})},$=async t=>I(t).then(r=>r.map(b=>({label:b.nama,value:b.id}))),w=async t=>oe(t).then(r=>r.map(b=>({label:b.nama,value:b.id})));l.useEffect(()=>{R(),P()},[]);const O=()=>{i(!1),h(!1),f({contact:null,sales:null,status:null,created_at:null})},p=(t,r)=>{if(r==="createdBy")return f({...o,createdBy:t.value});f({...o,[r]:t})},g=()=>{i(!1),h(!1),f({contact:null,sales:null,status:null,created_at:null}),x({})};return console.log(o),s("div",{children:[d?s("button",{onClick:()=>_(),className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:[e(A,{}),e("span",{className:"ml-2",children:"Show Filter"})]}):s("button",{onClick:()=>_(),className:" bg-white border  text-blue-700 hover:text-blue-700/90 delay-100 ease-in-out focus:ring-4 focus:outline-none focus:ring-blue-300  font-medium rounded-lg  text-sm px-4 py-2 text-center inline-flex items-center ",children:[e(G,{}),e("span",{className:"ml-2",children:"Filter"})]}),e(J,{title:"Filter",open:c,onOk:()=>{x(o),h(!0),i(!1)},cancelText:d?"Clear Filter":"Cancel",onCancel:d?g:O,okText:"Apply Filter",children:s("div",{children:[s("div",{children:[e("label",{htmlFor:"",children:"Contact"}),e(T,{showSearch:!0,placeholder:"Cari Contact",fetchOptions:$,filterOption:!1,className:"w-full mb-2",defaultOptions:k,value:(M=o==null?void 0:o.contact)==null?void 0:M.value,onChange:t=>{p(t,"contact"),C([{label:t.label,value:t.value}])}})]}),s("div",{children:[e("label",{htmlFor:"",children:"Sales"}),e(T,{defaultOptions:m==="sales"?[{label:v.name,value:v.id}]:L,showSearch:!0,placeholder:"Cari Sales",fetchOptions:w,filterOption:!1,className:"w-full mb-2",value:(y=o==null?void 0:o.sales)==null?void 0:y.value,onChange:t=>{p(t,"sales"),D([{label:t.label,value:t.value}])}})]}),s("div",{children:[e("label",{htmlFor:"",children:"Status"}),s(u,{mode:"multiple",allowClear:!0,className:"w-full mb-2",placeholder:"Select Status",onChange:t=>p(t,"status"),children:[e(u.Option,{value:7,children:"Draft"}),e(u.Option,{value:0,children:"Created"}),e(u.Option,{value:1,children:"Qualified"}),e(u.Option,{value:2,children:"Waiting Approval"}),e(u.Option,{value:3,children:"Unqualified"}),e(u.Option,{value:4,children:"Cancel By User"}),e(u.Option,{value:5,children:"Other"}),e(u.Option,{value:6,children:"Rejected"})]})]}),s("div",{className:"mb-2",children:[e("label",{htmlFor:"",children:"Tanggal"}),e(ie,{className:"w-full",format:"YYYY-MM-DD",onChange:(t,r)=>p(r,"created_at")})]})]})})]})},fe=()=>{const x=W();H();const[v,c]=l.useState(!1),[i,d]=l.useState(!1),[h,m]=l.useState([]),[F,k]=l.useState(0),[C,L]=l.useState(""),[D,o]=l.useState(!1),[f,_]=l.useState(1),[R,P]=l.useState({}),[$,w]=l.useState(!1),[O,p]=l.useState([]),g=(n="/api/lead-master",N=10,B={page:f})=>{c(!0),E.post(n,{perpage:N,account_id:se("account_id"),...B}).then(Y=>{const{data:q,total:K,current_page:U}=Y.data.data;k(K),_(U);const z=q.map(a=>({id:a.uid_lead,title:a.title,contact:(a==null?void 0:a.contact_name)||"-",sales:(a==null?void 0:a.sales_name)||"-",created_by:(a==null?void 0:a.created_by_name)||"-",brand:(a==null?void 0:a.brand_name)||"-",created_on:a==null?void 0:a.created_on,status:a==null?void 0:a.status_name}));m(z),c(!1)})};l.useEffect(()=>{g()},[]);const M=(n,N=10)=>{g(`/api/lead-master/?page=${n}`,N,{search:C,page:n,...R})},y=()=>{o(!0),g("/api/lead-master",10,{search:C})},t=n=>{P(n),g("/api/lead-master",10,n)},r=()=>{w(!0),E.post("/api/lead-master/export/",{items:O}).then(n=>{const{data:N}=n.data;p([]),window.open(N),w(!1)}).catch(n=>w(!1))},S={selectedRowKeys:O,onChange:n=>p(n),getCheckboxProps:n=>({disabled:n.status_submit==="submited"})},b=s("div",{className:"flex justify-between items-center",children:[e(ue,{handleOk:t}),e(ce,{color:"green",icon:e(V,{}),label:" Export",onClick:()=>r(),loading:$,disabled:O.length===0}),s("button",{onClick:()=>x("/lead-master/form"),className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center ml-2",children:[i?e(j,{}):e(X,{}),e("span",{className:"ml-2",children:"Tambah Data"})]})]});return s(Z,{rightContent:b,title:"List Lead Master",children:[s("div",{className:"row mb-4",children:[e("div",{className:"col-md-12"}),e("div",{className:"col-md-4 col-sm-6 col-12",children:e(ee,{placeholder:"Cari disini",size:"large",className:"rounded",onPressEnter:()=>y(),suffix:D?e(te,{onClick:()=>{g(),L(null),o(!1)}}):e(ae,{onClick:()=>y()}),value:C,onChange:n=>L(n.target.value)})}),e("div",{className:"col-md-8",children:s("strong",{className:"float-right mt-3 text-red-400",children:["Total Data: ",F]})})]}),e(le,{rowSelection:S,dataSource:h,columns:re,loading:v,pagination:!1,rowKey:"id",scroll:{x:"max-content"},tableLayout:"auto"}),e(ne,{defaultCurrent:1,current:f,total:F,className:"mt-4 text-center",onChange:M,pageSizeOptions:["10","20","50","100","200","500"]})]})};export{fe as default};
