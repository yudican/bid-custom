import{u as A,F as n,s as Q,r,j as t,L as w,x as U,b as c,an as X,ah as i,aY as y,I as Z,a as o,q as ee,t as h}from"./app-dfe09891.js";import{s as N,a as x}from"./service-372f6e11.js";const se=()=>{const O=A(),d=JSON.parse(localStorage.getItem("user_data")),p=localStorage.getItem("role"),[u]=n.useForm(),{uid_lead:m}=Q(),[L,_]=r.useState([]),[C,I]=r.useState([]),[P,T]=r.useState([]),[F,f]=r.useState(!1),[R,q]=r.useState([]),[D,B]=r.useState([]),[G,b]=r.useState(0),[W,k]=r.useState(null),j=()=>{o.get("/api/master/brand").then(e=>{T(e.data.data)})},E=()=>{o.get("/api/master/warehouse").then(e=>{_(e.data.data)})},H=()=>{o.get("/api/master/top").then(e=>{I(e.data.data)})},M=()=>{f(!0),o.get(`/api/lead-master/detail/${m}`).then(e=>{var l,g,S,v;const{data:a}=e.data,s={...a,contact:{label:a==null?void 0:a.contact_name,value:(l=a==null?void 0:a.contact_user)==null?void 0:l.id},sales:{label:(g=a==null?void 0:a.sales_user)==null?void 0:g.name,value:(S=a==null?void 0:a.sales_user)==null?void 0:S.id},payment_term:(v=a==null?void 0:a.payment_term)==null?void 0:v.id,brand_id:a==null?void 0:a.brand_ids};p==="sales"&&(s.sales={label:d.name,value:d.id}),k(a),u.setFieldsValue(s),f(!1)}).catch(e=>f(!1))};r.useEffect(()=>{j(),E(),H(),M(),J(),K()},[]);const J=()=>{N(null).then(e=>{const a=e.map(s=>({label:s.nama,value:s.id}));q(a)})},K=()=>{x(null).then(e=>{const a=e.map(s=>({label:s.nama,value:s.id}));B(a)})},V=async e=>N(e).then(a=>a.map(l=>({label:l.nama,value:l.id}))),Y=async e=>x(e).then(a=>a.map(l=>({label:l.nama,value:l.id}))),$=e=>{let a=m?"/api/lead-master/update/"+m:"/api/lead-master/create";o.post(a,{...e,status:G,uid_lead:m,contact:e.contact.value,sales:e.sales.value,account_id:ee("account_id")}).then(s=>{var l;return h.success((l=s==null?void 0:s.data)==null?void 0:l.message,{position:h.POSITION.TOP_RIGHT}),O("/lead-master")}).catch(s=>{h.error("Lead Gagal Disimpan",{position:h.POSITION.TOP_RIGHT})})};if(F)return t(w,{title:"Lead Master Form",href:"/lead-master",children:t(U,{})});const z=!W;return c(w,{title:"Create New Lead",href:"/lead-master",children:[t(n,{form:u,name:"basic",layout:"vertical",onFinish:$,autoComplete:"off",children:t(X,{title:"Form New Lead",children:c("div",{className:"card-body row",children:[c("div",{className:"col-md-4",children:[t(n.Item,{label:"Type Lead",name:"lead_type",rules:[{required:!0,message:"Please input Type Lead!"}],children:c(i,{placeholder:"Select Type Lead",children:[t(i.Option,{value:"new",children:"New Lead"},"new"),t(i.Option,{value:"existing",children:"Existing Lead"},"existing")]})}),t(n.Item,{label:"Brand",name:"brand_id",rules:[{required:!0,message:"Please input your Brand!"}],children:t(i,{placeholder:"Select Brand",mode:"multiple",allowClear:!0,children:P.map(e=>t(i.Option,{value:e.id,children:e.name},e.id))})})]}),c("div",{className:"col-md-4",children:[t(n.Item,{label:"Contact",name:"contact",rules:[{required:!0,message:"Please input Contact!"}],children:t(y,{showSearch:!0,placeholder:"Cari Contact",fetchOptions:V,filterOption:!1,className:"w-full",defaultOptions:R})}),t(n.Item,{label:"Payment Term",name:"payment_term",rules:[{required:!0,message:"Please input your Payment Term!"}],children:t(i,{placeholder:"Select Payment Term",children:C.map(e=>t(i.Option,{value:e.id,children:e.name},e.id))})})]}),c("div",{className:"col-md-4",children:[t(n.Item,{label:"Sales",name:"sales",rules:[{required:!0,message:"Please input Sales!"}],children:t(y,{disabled:p==="sales",defaultOptions:p==="sales"?[{label:d.name,value:d.id}]:D,showSearch:!0,placeholder:"Cari Sales",fetchOptions:Y,filterOption:!1,className:"w-full"})}),t(n.Item,{label:"Warehouse",name:"warehouse_id",rules:[{required:!0,message:"Please input your Warehouse!"}],children:t(i,{placeholder:"Select Warehouse",children:L.map(e=>t(i.Option,{value:e.id,children:e.name},e.id))})})]}),t("div",{className:"col-md-12",children:t(n.Item,{label:"Customer Need",name:"customer_need",children:t(Z,{placeholder:"Ketik Customer Need"})})})]})})}),t("div",{className:"float-right",children:c("div",{className:"  w-full mt-6 p-4 flex flex-row",children:[z&&t("button",{onClick:()=>{b(7),setTimeout(()=>{u.submit()},1e3)},className:"text-blue bg-white hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 border font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center mr-2",children:t("span",{className:"ml-2",children:"Save Draft"})}),t("button",{onClick:()=>{b(0),setTimeout(()=>{u.submit()},1e3)},className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center inline-flex items-center",children:t("span",{className:"ml-2",children:"Save Lead"})})]})})]})};export{se as default};
